
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>connexion &#8212; OpenAlchemy 0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Examples" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="connexion">
<h1><a class="toc-backref" href="#id1">connexion</a><a class="headerlink" href="#connexion" title="Permalink to this headline">¶</a></h1>
<p>connexion is a package that allows you to define Flask APIs and how endpoints
are fulfilled using an OpenAPI specification. This has the advantage that a UI
is automatically generated and data that is passed to endpoints is validated
based on the OpenAPI specification. By combining connexion with
OpenAlchemy, the OpenAPI specification not only defines the Flask application
but also the SQLALchemy models.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#connexion" id="id1">connexion</a></p>
<ul>
<li><p><a class="reference internal" href="#api-specification" id="id2">API specification</a></p></li>
<li><p><a class="reference internal" href="#database-models" id="id3">Database Models</a></p></li>
<li><p><a class="reference internal" href="#endpoint-fulfillment" id="id4">Endpoint Fulfillment</a></p></li>
<li><p><a class="reference internal" href="#app-construction" id="id5">App Construction</a></p></li>
<li><p><a class="reference internal" href="#conclusion" id="id6">Conclusion</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://connexion.readthedocs.io/en/latest/">connexion documentation</a></dt><dd><p>Documentation for connexion.</p>
</dd>
</dl>
</div>
<div class="section" id="api-specification">
<h2><a class="toc-backref" href="#id2">API specification</a><a class="headerlink" href="#api-specification" title="Permalink to this headline">¶</a></h2>
<p>As the case for combining connexion with OpenAlchemy is compelling, an
example application has been included here. The API is designed to keep track
of employees of a company. The OpenAPI specification is:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">openapi</span><span class="p">:</span> <span class="s">&quot;3.0.0&quot;</span>

<span class="nt">info</span><span class="p">:</span>
  <span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Test Schema</span>
  <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">API to illustrate OpenAlchemy.</span>
  <span class="nt">version</span><span class="p">:</span> <span class="s">&quot;1.0&quot;</span>

<span class="nt">paths</span><span class="p">:</span>
  <span class="nt">/employee</span><span class="p">:</span>
    <span class="nt">get</span><span class="p">:</span>
      <span class="nt">operationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.search</span>
      <span class="nt">summary</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Used to retrieve all employees.</span>
      <span class="nt">responses</span><span class="p">:</span>
        <span class="nt">200</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Return all employees from the database.</span>
          <span class="nt">content</span><span class="p">:</span>
            <span class="nt">application/json</span><span class="p">:</span>
              <span class="nt">schema</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
                <span class="nt">items</span><span class="p">:</span>
                  <span class="nt">$ref</span><span class="p">:</span> <span class="s">&quot;#/components/schemas/Employee&quot;</span>
    <span class="nt">post</span><span class="p">:</span>
      <span class="nt">operationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.post</span>
      <span class="nt">summary</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Used to save an employee to the database.</span>
      <span class="nt">requestBody</span><span class="p">:</span>
        <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The employee to save.</span>
        <span class="nt">required</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">content</span><span class="p">:</span>
          <span class="nt">application/json</span><span class="p">:</span>
            <span class="nt">schema</span><span class="p">:</span>
              <span class="nt">$ref</span><span class="p">:</span> <span class="s">&quot;#/components/schemas/Employee&quot;</span>
      <span class="nt">responses</span><span class="p">:</span>
        <span class="nt">200</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Save successful.</span>
        <span class="nt">400</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee already exists.</span>
  <span class="l l-Scalar l-Scalar-Plain">/employee/{id}</span><span class="p p-Indicator">:</span>
    <span class="nt">parameters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">in</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">path</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">id</span>
        <span class="nt">schema</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="nt">required</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">get</span><span class="p">:</span>
      <span class="nt">operationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.get</span>
      <span class="nt">summary</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Used to retrieve an Employee from the database.</span>
      <span class="nt">responses</span><span class="p">:</span>
        <span class="nt">200</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee.</span>
          <span class="nt">content</span><span class="p">:</span>
            <span class="nt">application/json</span><span class="p">:</span>
              <span class="nt">schema</span><span class="p">:</span>
                <span class="nt">$ref</span><span class="p">:</span> <span class="s">&quot;#/components/schemas/Employee&quot;</span>
        <span class="nt">404</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee was not found.</span>
    <span class="nt">patch</span><span class="p">:</span>
      <span class="nt">operationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.patch</span>
      <span class="nt">summary</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Update an Employee in the database.</span>
      <span class="nt">requestBody</span><span class="p">:</span>
        <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The employee to save.</span>
        <span class="nt">required</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">content</span><span class="p">:</span>
          <span class="nt">application/json</span><span class="p">:</span>
            <span class="nt">schema</span><span class="p">:</span>
              <span class="nt">$ref</span><span class="p">:</span> <span class="s">&quot;#/components/schemas/Employee&quot;</span>
      <span class="nt">responses</span><span class="p">:</span>
        <span class="nt">200</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee was updated.</span>
        <span class="nt">404</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee was not found.</span>
    <span class="nt">delete</span><span class="p">:</span>
      <span class="nt">operationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.delete</span>
      <span class="nt">summary</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Delete an Employee from the database.</span>
      <span class="nt">responses</span><span class="p">:</span>
        <span class="nt">200</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee was deleted.</span>
        <span class="nt">404</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Employee was not found.</span>

<span class="nt">components</span><span class="p">:</span>
  <span class="nt">schemas</span><span class="p">:</span>
    <span class="nt">Employee</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Person that works for a company.</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
      <span class="nt">x-tablename</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">employee</span>
      <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">id</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Unique identifier for the employee.</span>
          <span class="nt">example</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
          <span class="nt">x-primary-key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
          <span class="nt">x-autoincrement</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">name</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The name of the employee.</span>
          <span class="nt">example</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">David Andersson</span>
          <span class="nt">x-index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">division</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The part of the company the employee works in.</span>
          <span class="nt">example</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Engineering</span>
          <span class="nt">x-index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">salary</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
          <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The amount of money the employee is paid.</span>
          <span class="nt">example</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000000.00</span>
      <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">id</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">division</span>
</pre></div>
</td></tr></table></div>
<p>There is a <em>POST</em> endpoint for inserting new employees into the database, a
<em>GET</em> endpoint for all employees and for a specific employee by id, there is a
<em>PATCH</em> endpoint for updating an employee and a <em>DELETE</em> endpoint for deleting
an employee.</p>
</div>
<div class="section" id="database-models">
<h2><a class="toc-backref" href="#id3">Database Models</a><a class="headerlink" href="#database-models" title="Permalink to this headline">¶</a></h2>
<p>The OpenAPI specification above includes a <em>schemas</em> section which defines the
<em>Employee</em> schema. This schema is used to construct the <em>Employee</em> model. The
database setup is defined in the following file:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Setup for the database.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>

<span class="kn">from</span> <span class="nn">open_alchemy</span> <span class="kn">import</span> <span class="n">init_yaml</span>

<span class="c1"># Construct models</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">()</span>
<span class="n">SPEC_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">SPEC_FILE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SPEC_DIR</span><span class="p">,</span> <span class="s2">&quot;api.yaml&quot;</span><span class="p">)</span>
<span class="n">MODELS_FILENAME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SPEC_DIR</span><span class="p">,</span> <span class="s2">&quot;models_autogenerated.py&quot;</span><span class="p">)</span>
<span class="n">init_yaml</span><span class="p">(</span><span class="n">SPEC_FILE</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">models_filename</span><span class="o">=</span><span class="n">MODELS_FILENAME</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="endpoint-fulfillment">
<h2><a class="toc-backref" href="#id4">Endpoint Fulfillment</a><a class="headerlink" href="#endpoint-fulfillment" title="Permalink to this headline">¶</a></h2>
<p>The API endpoints are all fulfilled in the <em>api.py</em> file which has a function
for each combination of path and method:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Functions handling API endpoints.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">database</span>
<span class="kn">import</span> <span class="nn">models_autogenerated</span> <span class="k">as</span> <span class="nn">models</span>


<span class="k">def</span> <span class="nf">search</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Get all employees from the database.&quot;&quot;&quot;</span>
    <span class="n">employees</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">employee_dicts</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">employee</span><span class="p">:</span> <span class="n">employee</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">employees</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">employee_dicts</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save an employee to the database.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">body</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Employee already exists.&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">employee</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="o">**</span><span class="n">body</span><span class="p">)</span>
    <span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">employee</span><span class="p">)</span>
    <span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an employee from the database.&quot;&quot;&quot;</span>
    <span class="n">employee</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">employee</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Employee not found.&quot;</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">employee</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">patch</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update an employee in the dayabase.&quot;&quot;&quot;</span>
    <span class="n">employee</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">employee</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Employee not found.&quot;</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>
    <span class="n">employee</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="n">employee</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s2">&quot;division&quot;</span><span class="p">]</span>
    <span class="n">employee</span><span class="o">.</span><span class="n">salary</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span>
    <span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">200</span>


<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an employee from the database.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Employee</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Employee not found.&quot;</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>
    <span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">200</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="app-construction">
<h2><a class="toc-backref" href="#id5">App Construction</a><a class="headerlink" href="#app-construction" title="Permalink to this headline">¶</a></h2>
<p>All the steps needed to make the Flask app work are defined in the <em>app.py</em>
file:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Application code.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">connexion</span>

<span class="kn">import</span> <span class="nn">database</span>

<span class="c1"># Creating Flask app</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">connexion</span><span class="o">.</span><span class="n">FlaskApp</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">specification_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="c1"># Initializing database</span>
<span class="n">app</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;SQLALCHEMY_DATABASE_URI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sqlite:///:memory:&quot;</span>
<span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">app</span><span class="p">)</span>
<span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
    <span class="n">database</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_all</span><span class="p">()</span>

<span class="c1"># Running app</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_api</span><span class="p">(</span><span class="s2">&quot;api.yaml&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="conclusion">
<h2><a class="toc-backref" href="#id6">Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The duplication of the data schema has been reduced by defining the SQLAlchemy
models based on the OpenAPI specification. This means that, to change the
database schema, the OpenAPI specification has to be updated and vice-versa.
This ensures that the two are always in synch and up to date.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../technical_details/index.html">Technical Details</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">connexion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api-specification">API specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database-models">Database Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#endpoint-fulfillment">Endpoint Fulfillment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#app-construction">App Construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Examples</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Examples</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/connexion.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, David Andersson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/examples/connexion.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>